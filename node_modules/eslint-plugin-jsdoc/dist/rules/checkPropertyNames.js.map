{"version":3,"sources":["../../src/rules/checkPropertyNames.js"],"names":["validatePropertyNames","targetTagName","jsdoc","jsdocNode","utils","propertyTags","tags","filter","tag","name","includes","some","index","tagsIndex","dupeTagInfo","find","tgsIndex","tg","idx","reportJSDoc","splice","validatePropertyNamesDeep","jsdocPropertyNames","report","lastRealProperty","jsdocPropertyName","isPropertyPath","pathRootNodeName","slice","indexOf","endsWith","jsdocPropertyNamesDeep","getJsdocNamesDeep","length","getPreferredTagName","tagName","isError","iterateAllJsdocs","meta","fixable","type"],"mappings":"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","sourcesContent":["import entries from 'object.entries-ponyfill';\nimport iterateJsdoc from '../iterateJsdoc';\n\nconst validatePropertyNames = (\n  targetTagName : string,\n  jsdoc, jsdocNode, utils,\n) => {\n  const propertyTags = entries(jsdoc.tags).filter(([, tag]) => {\n    return tag.tag === targetTagName && !tag.name.includes('.');\n  });\n\n  return propertyTags.some(([, tag], index) => {\n    let tagsIndex;\n    const dupeTagInfo = propertyTags.find(([tgsIndex, tg], idx) => {\n      tagsIndex = tgsIndex;\n\n      return tg.name === tag.name && idx !== index;\n    });\n    if (dupeTagInfo) {\n      utils.reportJSDoc(`Duplicate @${targetTagName} \"${tag.name}\"`, dupeTagInfo[1], () => {\n        jsdoc.tags.splice(tagsIndex, 1);\n      });\n\n      return true;\n    }\n\n    return false;\n  });\n};\n\nconst validatePropertyNamesDeep = (\n  targetTagName : string,\n  jsdocPropertyNames : Array<string>, jsdoc, report : Function,\n) => {\n  let lastRealProperty;\n\n  return jsdocPropertyNames.some(({name: jsdocPropertyName, idx}) => {\n    const isPropertyPath = jsdocPropertyName.includes('.');\n\n    if (isPropertyPath) {\n      if (!lastRealProperty) {\n        report(`@${targetTagName} path declaration (\"${jsdocPropertyName}\") appears before any real property.`, null, jsdoc.tags[idx]);\n\n        return true;\n      }\n\n      let pathRootNodeName = jsdocPropertyName.slice(0, jsdocPropertyName.indexOf('.'));\n\n      if (pathRootNodeName.endsWith('[]')) {\n        pathRootNodeName = pathRootNodeName.slice(0, -2);\n      }\n\n      if (pathRootNodeName !== lastRealProperty) {\n        report(\n          `@${targetTagName} path declaration (\"${jsdocPropertyName}\") root node name (\"${pathRootNodeName}\") ` +\n          `does not match previous real property name (\"${lastRealProperty}\").`,\n          null,\n          jsdoc.tags[idx],\n        );\n\n        return true;\n      }\n    } else {\n      lastRealProperty = jsdocPropertyName;\n    }\n\n    return false;\n  });\n};\n\nexport default iterateJsdoc(({\n  jsdoc,\n  jsdocNode,\n  report,\n  utils,\n}) => {\n  const jsdocPropertyNamesDeep = utils.getJsdocNamesDeep('property');\n  if (!jsdocPropertyNamesDeep.length) {\n    return;\n  }\n  const targetTagName = utils.getPreferredTagName({tagName: 'property'});\n  const isError = validatePropertyNames(\n    targetTagName,\n    jsdoc, jsdocNode, utils,\n  );\n\n  if (isError) {\n    return;\n  }\n\n  validatePropertyNamesDeep(\n    targetTagName, jsdocPropertyNamesDeep,\n    jsdoc, report,\n  );\n}, {\n  iterateAllJsdocs: true,\n  meta: {\n    fixable: 'code',\n    type: 'suggestion',\n  },\n});\n"],"file":"checkPropertyNames.js"}